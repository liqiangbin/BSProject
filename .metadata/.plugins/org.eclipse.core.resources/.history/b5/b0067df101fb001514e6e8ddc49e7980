
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;

import org.apache.commons.lang.StringUtils;

/**
 * æ—¥æœŸUtilç±?
 * @author wangwch
 */
public class DateUtil {
	private static String defaultDatePattern = "yyyyMMdd";

	/**
	 * è·å¾—é»˜è®¤çš? date pattern
	 */
	private static String getDatePattern() {
		return defaultDatePattern;
	}

	/**
	 * è¿”å› å½“å‰æ—¥æœŸå­—ç¬¦ä¸?
	 * @return yyyyMMdd 
	 */
	public static String getToday() {
		Date today = new Date();
		return format(today);
	}

	/**
	 * ä½¿ç”¨é¢„è®¾Formatæ ¼å¼åŒ–Dateæˆå­—ç¬¦ä¸²
	 */
	public static String format(Date date) {
		return date == null ? "" : format(date, getDatePattern());
	}

	/**
	 * ä½¿ç”¨å‚æ•°Formatæ ¼å¼åŒ–Dateæˆå­—ç¬¦ä¸²
	 */
	public static String format(Date date, String pattern) {
		return date == null ? "" : new SimpleDateFormat(pattern).format(date);
	}

	/**
	 * ä½¿ç”¨é¢„è®¾æ ¼å¼å°†å­—ç¬¦ä¸²è½¬ä¸ºDate
	 */
	public static Date parse(String strDate) throws ParseException {
		return StringUtils.isBlank(strDate) ? null : parse(strDate, getDatePattern());
	}

	/**
	 * ä½¿ç”¨å‚æ•°Formatå°†å­—ç¬¦ä¸²è½¬ä¸ºDate
	 */
	public static Date parse(String strDate, String pattern) throws ParseException {
		return StringUtils.isBlank(strDate) ? null : new SimpleDateFormat(pattern).parse(strDate);
	}

	/**
	 * åœ¨æ—¥æœŸä¸Šå¢åŠ æ•°ä¸ªæ•´æœˆ
	 */
	public static Date addMonth(Date date, int n) {
		Calendar cal = Calendar.getInstance();
		cal.setTime(date);
		cal.add(Calendar.MONTH, n);
		return cal.getTime();
	}

	/**
	 * è·å¾—æœˆæœ«æ—?
	 */
	public static Date getLastDayOfMonth(String year, String month, int flag) {

		Calendar cal = Calendar.getInstance();
		//å¹?
		cal.set(Calendar.YEAR, Integer.parseInt(year));
		//æœˆï¼Œå› ä¸ºCalendaré‡Œçš„æœˆæ˜¯ä»?0å¼?å§‹ï¼Œæ‰?ä»¥è¦-1
		cal.set(Calendar.MONTH, Integer.parseInt(month) - 1);
		//æ—¥ï¼Œè®¾ä¸ºä¸?å?
		cal.set(Calendar.DATE, 1);
		//æœˆä»½åŠ ä¸€ï¼Œå¾—åˆ°ä¸‹ä¸ªæœˆçš„ä¸€å?
		cal.add(Calendar.MONTH, flag);
		//ä¸‹ä¸€ä¸ªæœˆå‡ä¸€ä¸ºæœ¬æœˆæœ€åä¸€å¤?
		cal.add(Calendar.DATE, -1);
		return cal.getTime();
	}

	/**
	 * è·å¾—æœˆæœ«æ—?: flag=1:è·å¾—ä¸Šæœˆæœˆæœ«æ—? flag=0ï¼šè·å¾—æœ¬æœˆæœˆæœ«æ—¥
	 */
	public static Date getLastDayOfMonth(Date date, int flag) {
		Calendar cal = Calendar.getInstance();
		cal.setTime(date);
		//æ—¥ï¼Œè®¾ä¸ºä¸?å?
		cal.set(Calendar.DATE, 1);
		//æœˆä»½åŠ ä¸€ï¼Œå¾—åˆ°ä¸‹ä¸ªæœˆçš„ä¸€å?
		cal.add(Calendar.MONTH, flag);
		//ä¸‹ä¸€ä¸ªæœˆå‡ä¸€ä¸ºæœ¬æœˆæœ€åä¸€å¤?
		cal.add(Calendar.DATE, -1);
		return cal.getTime();
	}

	/**
	 * è·å¾—å‘¨æœ«æ—?
	 */
	public static Date getLastDayOfWeek(Date date) {
		Calendar cal = Calendar.getInstance();
		cal.setTime(date);
		cal.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);
		cal.add(Calendar.DATE, -1);
		return cal.getTime();
	}

	/**
	 * åœ¨æ—¥æœŸä¸Šå¢åŠ æ•°å¤©
	 * @param date
	 * @param n
	 * @return 
	 */
	public static Date addDay(Date date, int n) {
		Calendar cal = Calendar.getInstance();
		cal.setTime(date);
		cal.add(Calendar.DAY_OF_MONTH, n);
		return cal.getTime();
	}

	/**
	 * å¾—åˆ°å½“å‰æ—¶é—´
	 * @return HHmmss
	 */
	public static String GetCurrentTime() {
		StringBuffer result = new StringBuffer();
		Calendar calendar = Calendar.getInstance();
		int h = calendar.get(Calendar.HOUR_OF_DAY);
		int m = calendar.get(Calendar.MINUTE);
		int s = calendar.get(Calendar.SECOND);
		if (h < 10) {
			result.append("0");
		}
		result.append(h);
		if (m < 10) {
			result.append("0");
		}
		result.append(m);
		if (s < 10) {
			result.append("0");
		}
		result.append(s);
		return result.toString();
	}

	/**
	 * å¾—åˆ°å½“å‰æ—¥æœŸæ—¶é—´ 
	 * @return yyyyMMddHHmmss
	 */
	public static String getCurrDateTime() {
		Date now = new Date();
		SimpleDateFormat outFormat = new SimpleDateFormat("yyyyMMddHHmmss");
		String s = outFormat.format(now);
		return s;
	}

	/**
	 * Formats a Date object to return a date using the global locale.
	 */
	public static String formatDate(Date date) {
		SimpleDateFormat outFormat = new SimpleDateFormat("yyyy-MM-dd");
		return outFormat.format(date);
	}

	/**
	 * Formats a Date object to return a date and time using the global locale.
	 */
	public static String formatDateTime(Date date) {
		SimpleDateFormat outFormat = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
		return outFormat.format(date);
	}

	public static String formatDate2(Date myDate) {
		SimpleDateFormat formatter = new SimpleDateFormat("yyyy/MM/dd");
		String strDate = formatter.format(myDate);
		return strDate;
	}

	public static String formatDate3(Date myDate) {
		SimpleDateFormat formatter = new SimpleDateFormat("MM-dd HH:mm");
		String strDate = formatter.format(myDate);
		return strDate;
	}

	public static String formatDate4(Date myDate) {
		SimpleDateFormat formatter = new SimpleDateFormat("yyyyMMdd");
		String strDate = formatter.format(myDate);
		return strDate;
	}

	public static String formatDate5(Date myDate) {
		String strDate = getYear(myDate) + "-" + getMonth(myDate) + "-" + getDay(myDate);
		return strDate;
	}

	public static String formatDate6(Date myDate) {
		SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm");
		String strDate = formatter.format(myDate);
		return strDate;
	}
	
	public static String formatDate7(Date myDate) {
		SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
		String strDate = formatter.format(myDate);
		return strDate;
	}

	public static long Date2Long(int year, int month, int date) {
		Calendar cld = Calendar.getInstance();
		month = month - 1;
		cld.set(year, month, date);
		return cld.getTime().getTime();
	}

	public static long Time2Long(int year, int month, int date, int hour, int minute, int second) {
		Calendar cld = Calendar.getInstance();
		month = month - 1;
		cld.set(year, month, date, hour, minute, second);
		return cld.getTime().getTime();
	}

	public static int getYear(long t) {
		Calendar cld = Calendar.getInstance();
		if (t > 0) {
			cld.setTime(new java.util.Date(t));
		}
		return cld.get(Calendar.YEAR);
	}

	public static int getMonth(long t) {
		Calendar cld = Calendar.getInstance();
		if (t > 0) {
			cld.setTime(new java.util.Date(t));
		}
		return cld.get(Calendar.MONTH) + 1;
	}

	public static int getDay(long t) {
		Calendar cld = Calendar.getInstance();
		if (t > 0) {
			cld.setTime(new java.util.Date(t));
		}
		return cld.get(Calendar.DAY_OF_MONTH);
	}

	public static int getHour(long t) {
		Calendar cld = Calendar.getInstance();
		if (t > 0) {
			cld.setTime(new java.util.Date(t));
		}
		return cld.get(Calendar.HOUR_OF_DAY);
	}

	public static int getMinute(long t) {
		Calendar cld = Calendar.getInstance();
		if (t > 0) {
			cld.setTime(new java.util.Date(t));
		}
		return cld.get(Calendar.MINUTE);
	}

	public static int getSecond(long t) {
		Calendar cld = Calendar.getInstance();
		if (t > 0) {
			cld.setTime(new java.util.Date(t));
		}
		return cld.get(Calendar.SECOND);
	}

	public static int getYear(Date date) {
		Calendar cld = Calendar.getInstance();
		cld.setTime(date);
		return cld.get(Calendar.YEAR);
	}

	public static int getMonth(Date date) {
		Calendar cld = Calendar.getInstance();
		cld.setTime(date);
		return cld.get(Calendar.MONTH) + 1;
	}

	public static int getDay(Date date) {
		Calendar cld = Calendar.getInstance();
		cld.setTime(date);
		return cld.get(Calendar.DAY_OF_MONTH);
	}

	public static int getHour(Date date) {
		Calendar cld = Calendar.getInstance();
		cld.setTime(date);
		return cld.get(Calendar.HOUR_OF_DAY);
	}

	public static int getMinute(Date date) {
		Calendar cld = Calendar.getInstance();
		cld.setTime(date);
		return cld.get(Calendar.MINUTE);
	}

	public static int getSecond(Date date) {
		Calendar cld = Calendar.getInstance();
		cld.setTime(date);
		return cld.get(Calendar.SECOND);
	}

	public static int getYear() {
		Calendar cld = Calendar.getInstance();
		cld.setTime(new java.util.Date());
		return cld.get(Calendar.YEAR);
	}

	public static int getMonth() {
		Calendar cld = Calendar.getInstance();
		cld.setTime(new java.util.Date());
		return cld.get(Calendar.MONTH) + 1;
	}

	public static int getDay() {
		Calendar cld = Calendar.getInstance();
		cld.setTime(new java.util.Date());
		return cld.get(Calendar.DAY_OF_MONTH);
	}

	/**
	 * æŠŠæ—¥æœŸè½¬æˆ?2006/12/30æ ¼å¼
	 * @param date
	 * @return
	 */
	public static String formatDate(String date) {
		if (date != null && date.trim().length() >= 8) {
			return date.substring(0, 4) + "-" + date.substring(4, 6) + "-" + date.substring(6, 8);
		}
		return date;
	}

	public static String formatTime(String time) {
		if (time != null && time.trim().length() >= 6) {
			return time.substring(0, 2) + ":" + time.substring(2, 4) + ":" + time.substring(4, 6);
		}
		return time;
	}

	public static String formateTimeOfDay(String time) {
		if (time != null && time.trim().length() >= 12) {
			return time.substring(0, 4) + "-" + time.substring(4, 6) + "-" + time.substring(6, 8) + " "
					+ time.substring(8, 10) + "ï¼?" + time.substring(10, 12);
		}
		return time;
	}

	/**
	 * è·å¾—ä¸¤å¤©ä¹‹é—´ç›¸å·®å¤©æ•° date-date1
	 * @param date    
	 * @param date1
	 * @return
	 */
	public static int getDiffDate(java.util.Date date, java.util.Date date1) {
		return (int) ((date.getTime() - date1.getTime()) / (24 * 3600 * 1000));
	}

	/**
	 * è·å–ä¸¤ä¸ªæ—¶é—´çš„ç§’å·?  date-date1
	 * @param date
	 * @param date1
	 * @return
	 */
	public static long getDiffTime(java.util.Date date, java.util.Date date1) {
		return (date.getTime() - date1.getTime()) / 1000;
	}

	/**
	 * ä»? yyyyMMddHHmmssæ ¼å¼çš„æ—¶é—´ä¸­ è·å–æ—¥æœŸ yyyyMMdd
	 * @param time
	 * @return yyyyMMdd
	 */
	public static String getDateFromyyyyMMddHHmmss(String time) {
		return time.substring(0, 8);
	}

	/**
	 * ä»? yyyyMMddHHmmssæ ¼å¼çš„æ—¶é—´ä¸­ è·å–æ—¶é—´ HHmmss
	 * @param time
	 * @return HHmmss
	 */
	public static String getTimeFromyyyyMMddHHmmss(String time) {
		return time.substring(8, 14);
	}

	public static void main(String args[]) throws ParseException {
		//    	Date date = new Date();
		//    	Date d = getLastDayOfWeek(date);
		//    	System.out.println("d:" + d);
		String fStr = "yyyyMMdd";
		SimpleDateFormat format = new SimpleDateFormat(fStr);
		String d1 = "20050101", d2 = "20050302";
		Date date1 = parse(d1), date2 = parse(d2);
		for (int i = 0; i <= getDiffDate(date2, date1); i++) {
			System.out.println(format.format(addDay(date1, i)));
		}
	}
	
	/*******************************************************************/
	
	
	public static String getTodayDate(){
		int y,m,d; 
		Calendar cal=Calendar.getInstance();
		y=cal.get(Calendar.YEAR);    
		m=cal.get(Calendar.MONTH)+1;    
		d=cal.get(Calendar.DATE);
		return  y+"-"+getDateFormat(m)+"-"+getDateFormat(d)+"";
	}
	
	public static String getYestodayDate(){
		int y,m,d;
		Calendar cal=Calendar.getInstance();
		cal.add(Calendar.DATE, -1);
		y=cal.get(Calendar.YEAR);    
		m=cal.get(Calendar.MONTH)+1;    
		d=cal.get(Calendar.DATE);
		return  y+"-"+getDateFormat(m)+"-"+getDateFormat(d)+"";
	}
	
	public static String getThisWeekBeginDate(){
		
		int y,m,d;
		Calendar cal=Calendar.getInstance();
		cal.add(Calendar.DATE, -cal.get( Calendar.DAY_OF_WEEK)+2);
		y=cal.get(Calendar.YEAR);
		m=cal.get(Calendar.MONTH)+1;
		d=cal.get(Calendar.DATE);
		
		return y+"-"+getDateFormat(m)+"-"+getDateFormat(d)+"";
	}
	
	
	
	public static String getThisMonthBeginDate(){
		
		int y,m,d;
		Calendar cal=Calendar.getInstance();
		//cal.add(Calendar.MONTH, -1);
		y=cal.get(Calendar.YEAR);    
		m=cal.get(Calendar.MONTH)+1;    
		d=1;
		return  y+"-"+getDateFormat(m)+"-"+getDateFormat(d)+"";
	}
	
	public static String getThisMonthEndDate(){
		
		int y,m,d;
		Calendar cal=Calendar.getInstance();
		cal.add(Calendar.MONTH, 1);
		cal.set(Calendar.DATE, 1);
		cal.add(Calendar.DATE, -1);
		y=cal.get(Calendar.YEAR);
		m=cal.get(Calendar.MONTH)+1;
		d=cal.get(Calendar.DATE);
		return  y+"-"+getDateFormat(m)+"-"+getDateFormat(d)+"";
	}
	
	
	private static String getDateFormat(int num){
		if(num <10){
			return "0"+num;
		}
		return ""+num;
	}
}